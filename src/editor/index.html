<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="apple-mobile-web-app-capable" content="yes" />

  <!-- No-op until loaded dynamically (could make configurable) -->
  <link rel="shortcut icon" href="data:image/x-icon;," type="image/x-icon" />

  <!-- STYLESHEETS (others loaded dynamically) -->
  <style id="styleoverrides" media="screen"></style>
  <link href="./svgedit.css" rel="stylesheet" media="all"></link>
  
  <!-- FiglinQ -->
  <link href="./extensions/ext-figlinq/ext-figlinq.css" rel="stylesheet" media="all"></link>
  <link href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bulma-switch@2.0.0/dist/css/bulma-switch.min.css" rel="stylesheet" media="all"></link>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet" integrity="sha512-1ycn6IcaQQ40/MKBW2W4Rhis/DbILU74C1vSrLJxCq57o941Ym01SwNsOMqvEBFlcgUa6xLiPY/NS5R+E6ztJQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <script src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.1/dist/js.cookie.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script> 
  <script src="https://cdn.jsdelivr.net/npm/bulma-toast@2.4.1/dist/bulma-toast.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/pdfkit@0.10.0/js/pdfkit.standalone.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/svg-to-pdfkit@0.1.8/source.js"></script>
  <!-- <script type="module" src="./extensions/ext-figlinq/svg-injector.js"></script> -->
  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/svg-injector/1.1.3/svg-injector.min.js" integrity="sha512-LpKoEmPyokcDYSjRJ/7WgybgdAYFsKtCrGC9m+VBwcefe1vHXyUnD9fTQb3nXVJda6ny1J84UR+iBtEYm3OQmQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script> -->

  <!-- SCRIPTS -->

  <!-- Lacking browser support -->
  <script type="module" src="./browser-not-supported.js"></script>

  <!-- If you do not wish to add extensions by URL, you can add calls
      within the following file to svgEditor.setConfig -->
  <script type="module">
    /* for available options see the file `docs/tutorials/ConfigOptions.md */
    import Editor from './Editor.js';
    const svgEditor = new Editor(document.getElementById('container'));
    svgEditor.init();
    svgEditor.setConfig({
      allowInitialUserOverride: true,
      extensions: [],
      noDefaultExtensions: false,
      userExtensions: ['./extensions/ext-figlinq/ext-figlinq.js'],
    });

    // Variable XDOMAIN below is created by Rollup for the Xdomain build (see rollup.config.js)
    /* globals XDOMAIN */
    try { // try clause to avoid js to complain if XDOMAIN undefined
      if (XDOMAIN) {
        svgEditor.setConfig({
          canvasName: 'xdomain', // Namespace this
          allowedOrigins: [ '*' ]
        });
        console.info('xdomain config activated');
      }
    } catch (error) {/* empty fn */ }
  </script>

  <title>Figure editor | FiglinQ</title>
</head>

<body style="margin:0">
  <!-- FiglinQ -->
  <script>
    // disable the beforeunload event
      // window.addEventListener('beforeunload', function(event) {
      //   event.stopImmediatePropagation();
      // }, true);
  </script>

  <div id="fq-spinner">
    <image src="./images/figlinq/spinner.gif" width="60" height="60" style="max-height:60px;"/>
  </div>
  <a href="https://github.com/SVG-Edit/svgedit" target="_blank" id="fq-powered-by-svgedit">
    <image style="margin-right:10px;" src="./images/logo.svg" width="20"/>
    <div>Powered by<br />
      <strong>SVG-edit</strong>
    </div>
  </a>

  <!-- Navbar -->
  <nav class="navbar is-info" role="navigation" aria-label="main navigation" style="background-color: rgb(8, 84, 125);">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://figlinq.com">
        <img src="images/figlinq/logo_text_dark.svg" width="80">
      </a>
  
      <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navbarBasicExample">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>
  
    <div id="navbar" class="navbar-menu">
      <div class="navbar-start">
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link">
            File
          </a>
          <div class="navbar-dropdown" style="min-width: 240px;">
            <a id="fq-menu-file-item-newfig" class="navbar-item">
              <span class="icon-text">
                <span class="icon">
                  <i class="far fa-file"></i>
                </span>
                <span>New figure</span>
              </span>              
            </a>
            <a id="fq-menu-item-open-figure" class="navbar-item is-hidden">
              <span class="icon-text">
                <span class="icon">
                  <i class="far fa-folder-open"></i>
                </span>
                <span>Open figure</span>
              </span>     
            </a>
            <a id="fq-menu-item-save-figure" class="navbar-item is-hidden is-disabled">
              <span class="icon-text">
                <span class="icon">
                  <i class="fas fa-save"></i>
                </span>
                <span>Save figure</span>
              </span>    
            </a>
            <a id="fq-menu-item-save-figure-as" class="navbar-item is-hidden">
              <span class="icon-text">
                <span class="icon">
                  <i class="far fa-save"></i>
                </span>
                <span>Save figure as...</span>
              </span>    
            </a>
            <a id="tool_import" class="navbar-item">
              <span class="icon-text">
                <span class="icon">
                  <i class="fas fa-file-import"></i>
                </span>
                <span>Import local content</span>
              </span>
            </a>
            <a id="fq-menu-file-item-export" class="navbar-item">
              <span class="icon-text">
                <span class="icon">
                  <i class="fas fa-file-export"></i>
                </span>
                <span>Export figure</span>
              </span>    
            </a>
            <a id="fq-menu-add-content-btn_menu" class="navbar-item fq-menu-add-content-btn is-hidden">
              <image style="margin-left:2px; margin-right:8px;" src="./images/figlinq/logo_gray.svg" width="16"/>
              Add FiglinQ content
            </a>
            <hr class="navbar-divider">
            <a id="fq-menu-item-doc-properties" class="navbar-item">
              <span class="icon-text">
                <span class="icon">
                  <i class="fas fa-cogs"></i>
                </span>
                <span>Document setup</span>
              </span>    
              
            </a>
          </div>
        </div>

        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link">
            View
          </a>
          <div class="navbar-dropdown" style="min-width: 200px;">
            <a id="fq-menu-show-grid" class="navbar-item">
              <span class="icon-text">
                <span class="icon">
                  <i class="far fa-square"></i>
                </span>
                <span>Show Grid</span>
              </span>              
            </a>
            <a id="fq-menu-show-rulers" class="navbar-item">
              <span class="icon-text">
                <span class="icon">
                  <i class="far fa-square"></i>
                </span>
                <span>Show rulers</span>
              </span>              
            </a>
          </div>
        </div>
        
        <div id="fq-menu-interact-switch-item" class="navbar-item is-hidden">
          <div class="field">
            <input id="fq-menu-interact-switch" type="checkbox" name="fq-menu-interact-switch" class="switch is-success">
            <label for="fq-menu-interact-switch">Figure interactivity</label>
          </div>
        </div>
      </div>
  
      <div class="navbar-end">
        <div class="navbar-item">
          <div class="buttons">
            <a id="fq-menu-add-content-btn_btn" class="button is-light is-small is-hidden fq-menu-add-content-btn is-hidden">
              <span class="icon">
                <i class="fas fa-plus"></i>
              </span>
              <span><strong>Add FiglinQ content</strong></span>
            </a>
            <a href="https://figlinq.com/sign-up" id="fq-menu-signup-btn" class="button is-light is-small is-hidden">
              <strong>Sign up</strong>
            </a>
            <a href="https://create.figlinq.com/organize/home/" id="fq-menu-login-btn" class="button is-light is-small is-hidden">
              Log in
            </a>
          </div>
        </div>
      </div>
    </div>
  </nav>
  <div id="container" style="width:100vw;height:calc(100vh - 52px);"></div>

  <!-- File Modal  -->
  <div id="fq-modal-file" class="modal">
    <div class="modal-background"></div>
    <div class="modal-content">
      <div class="box">
        <nav class="panel is-shadowless">
          <p id="file-panel-heading" class="panel-heading is-size-6">
            Select content
          </p>
          <div class="panel-block">
            <fieldset id="fq-modal-file-search-wrapper" style="width:100%;">
              <div class="field">
                <p class="control is-expanded has-icons-right">
                  <input id="fq-modal-file-search-input" class="input is-small" type="text" placeholder="Search (>2 characters)">
                  <span class="icon is-right">
                    <i id="fq-modal-file-search-icon" class="fas fa-search" aria-hidden="true" style="pointer-events: all; cursor: pointer;"></i>
                  </span>
                </p>
              </div>
            </fieldset>
          </div>
          <p id="panel_tabs" class="panel-tabs">
            <a href="#" id="fq-modal-file-tab-my" class="fq-modal-file-tab is-active" data-mode="my">My files</a>
            <a href="#" id="fq-modal-file-tab-shared" class="fq-modal-file-tab" data-mode="shared">Shared with me</a>
          </p>
          <div id="fq-modal-file-panel-breadcrumb" class="panel-block pl-0">
            <div class="breadcrumb is-size-7" aria-label="breadcrumbs">
              <ul>
                <li id="fq-breadcrumb-item-home" class="breadcrumb-item" data-fid="">
                  <a href="#" class="fq-modal-folder-item" data-fid="">&nbsp;
                    <span class="icon mx-0">
                      <i class="fas fa-home"></i>
                    </span>
                  </a>
                </li>
              </ul>
            </div>
          </div>
          <div id="fq-modal-file-search-title" class="panel-block pl-0 is-hidden">
            <div class="breadcrumb is-size-7" aria-label="breadcrumbs">
              <span class="icon-text">
                <span class="icon ml-1">
                  <i class="fas fa-search"></i>
                </span>
                <span><strong>Search results: </strong><span id="fq-modal-file-search-items-found"></span></span>
              </span>
            </div>
          </div>
          <div id="fq-modal-item-list-container" style="border-bottom: 1px solid #ededed; max-height: calc(100vh - 400px); overflow-y: auto; ">            
          </div>
          <div class="panel-block modal-action-panel content-add-panel is-hidden pt-5">
            <div class="field is-grouped">
              <div class="control">
                <button id="fq-modal-add-confirm-btn" class="button is-link is-small" disabled>
                  Add item(s)
                </button>
              </div>
              <div class="control">
                <button class="button is-link is-outlined fq-modal-cancel-btn is-small">
                  Cancel
                </button>
              </div>
              <div class="control">
                <div class="select is-small">
                  <select id="col_select">
                    <option value="1">1 column</option>
                    <option value="2">2 columns</option>
                    <option value="3">3 columns</option>
                    <option value="4">4 columns</option>
                  </select>
                </div>
              </div>
              <div class="control">
                <button id="fq-modal-refresh-btn" class="button is-small">
                  <span class="icon is-small">
                    <i class="fas fa-sync-alt"></i>
                  </span>
                </button>              
              </div>
            </div>
          </div>
          <div class="panel-block modal-action-panel file-save-panel is-hidden">
            <div class="control">
              <div class="field is-horizontal">
                <div class="field-label is-normal mr-2" style="padding-top: .5em;">
                  <label class="label is-size-7">File name:</label>
                </div>
                <div class="field-body">
                  <div class="field">
                    <p class="control">
                      <input id="fq-modal-save-name-input" class="input is-small" type="text">
                    </p>
                  </div>
                </div>
                <div class="field-label is-normal ml-2" style="padding-top: .5em; text-align: left; max-width: 30px;">
                  <label class="label is-size-7">.svg</label>
                </div>
              </div>              
            </div>
          </div>
          <div class="panel-block modal-action-panel file-save-panel is-hidden">
            <div class="field is-grouped">
              <div class="control">
                <div class="select is-small">
                  <select id="world_readable">
                    <option value="false">Private</option>
                    <option value="true">Public</option>
                  </select>
                </div>
              </div>
              <div class="control">
                <button id="fq-modal-save-confirm-btn" class="button is-link is-small" disabled>
                  Save
                </button>
              </div>
              <div class="control">
                <button class="button is-link is-outlined fq-modal-cancel-btn is-small">
                  Cancel
                </button>
              </div>
              <div class="control">
                <button id="fq-modal-refresh-btn" class="button is-small">
                  <span class="icon is-small">
                    <i class="fas fa-sync-alt"></i>
                  </span>
                </button>
              </div>
            </div>
          </div>

          <div class="panel-block modal-action-panel figure-open-panel is-hidden pt-5">
            <div class="field is-grouped">
              <div class="control">
                <button id="fq-modal-files-btn-openfig" class="button is-link is-small" disabled>
                  Open
                </button>
              </div>
              <div class="control">
                <button class="button is-link is-outlined fq-modal-cancel-btn is-small">
                  Cancel
                </button>
              </div>
              <div class="control">
                <button id="fq-modal-refresh-btn" class="button is-small">
                  <span class="icon is-small">
                    <i class="fas fa-sync-alt"></i>
                  </span>
                </button>
              </div>
            </div>
          </div>
        </nav>
      </div>
    </div>
  </div>

  <!-- Document setup modal  -->
  <div id="fq-modal-doc-setup" class="modal">
    <div class="modal-background"></div>
    <div class="modal-content">
      <div class="box is-shadowless">
        <nav class="panel is-shadowless">
          <p id="file-panel-heading" class="panel-heading is-size-6">
            Document setup
          </p>
          <div class="panel-block py-4">
            <div class="is-flex is-flex-direction-column">
              <p class="mb-3 is-size-7"><strong>Document units</strong></p>
              <div class="field">
                <!-- <label class="label">Predefined:</label> -->
                <div class="control">
                  <div class="select is-small">
                    <select id="fq-doc-baseunit">
                      <option value="px">Pixels</option>
                      <option value="mm">Millimeters</option>
                      <option value="cm">Centimeters</option>
                      <option value="in">Inches</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Document size -->
          <div class="panel-block py-4">
            <div class="is-flex is-flex-direction-column">
              <p class="mb-2 is-size-7"><strong>Document size</strong></p>
              <div class="field is-horizontal">
                <div class="field-body">
                  <div class="field">
                    <label class="label is-size-7">Predefined:</label>
                    <div class="control">
                      <div class="select is-small">
                        <select id="fq-doc-size">
                          <option value="">Select</option>
                          <option value="210mmx297mm">A4 format</option>
                          <option value="215.9mmx279.4mm">Letter format</option>
                          <option value="800x600">600 x 800px</option>
                          <option value="1200x1600">1200 x 1600px</option>
                          <!-- <option value="fit">Fit to content</option> -->
                        </select>
                      </div>
                    </div>
                  </div>
                  <div class="field">
                    <label class="label is-size-7">Width:</label>
                    <p class="control is-expanded has-icons-left">
                      <input id="fq-doc-setup-width" class="input is-small" type="text">
                    </p>
                  </div>
                  <div class="field">
                    <label class="label is-size-7">Height:</label>
                    <p class="control is-expanded has-icons-left">
                      <input id="fq-doc-setup-height" class="input is-small" type="text">
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Grid -->
          <div class="panel-block py-4">
            <div class="is-flex is-flex-direction-column">
              <p class="is-size-7"><strong>Grid & snapping</strong></p>
              <div class="field is-grouped is-align-items-center">
                <p class="control">
                  <label class="checkbox is-size-7">
                    <input id="fq-doc-setup-snapping-enabled" class="checkbox is-small" type="checkbox">
                    Snapping enabled
                  </label>
                </p>
                <p class="control ml-5">
                  <label class="checkbox is-size-7">Snapping step (px):</label>
                </p>
                <p class="control is-flex-shrink-1">
                  <input id="fq-doc-setup-snapping-step" class="input is-small" type="text">
                </p>
              </div>
            </div>
          </div>

          <!-- Action buttons -->
          <div class="panel-block py-4">
            <div class="field is-grouped">
              <div class="control">
                <button id="fq-doc-setup-save-btn" class="button is-link is-small">
                  Save
                </button>
              </div>
              <div class="control">
                <button class="button is-link is-outlined fq-modal-cancel-btn is-small">
                  Cancel
                </button>
              </div>
            </div>
          </div>
        </nav>
      </div>
    </div>
  </div>

  <!-- Confirmation modal -->
  <div id="fq-modal-confirm" class="modal">
    <div class="modal-background"></div>
    <div class="modal-content" style="max-width: 400px;">
      <div class="box">
        <p class="mb-5 is-size-7">All unsaved changes will be lost. Are you sure?</p>
        <div class="field is-grouped is-grouped-centered">
          <p class="control">
            <a id="fq-modal-confirm-btn-ok" class="button is-link is-small">
              Open
            </a>
          </p>
          <p class="control">
            <a class="button is-link is-outlined fq-modal-cancel-btn is-small">
              Cancel
            </a>
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Export modal -->
  <div id="fq-modal-export" class="modal">
    <div class="modal-background"></div>
    <div class="modal-content" style="max-width: 460px;">
      <div class="box">
        <p class="mb-5 is-size-6">Export figure</p>
        
        <!-- File name & format -->
        <div class="field is-grouped">
          <p class="control" style="margin-top: 2px;">
            <label class="is-size-7">Name/format:</label>
          </p>
          <div class="field has-addons">
            <p class="control">
              <input id="fq-modal-export-fname-input" value="Figure" class="input is-small" type="text">
            </p>
            <div class="control">
              <div class="select is-small">
                <select id="fq-modal-export-format-select">
                  <option value="png">.png</option>
                  <option value="jpeg">.jpg</option>
                  <option value="bmp">.bmp</option>
                  <option value="pdf">.pdf</option>
                </select>
              </div>
            </div>
          </div>
        </div>

        <!-- Quality -->
        <div class="field is-grouped is-align-items-baseline">
          <p class="control">
            <label class="is-size-7">Quality:</label>
          </p>
          <div class="field has-addons">
            <p class="control">
              <button id="fq-modal-export-quality-minus" class="button fq-modal-export-quality is-small" data-increment="-5">
                <span class="icon is-small" style="pointer-events: none;">
                  <i class="fas fa-minus fa-xs"></i> 
                </span>
              </button>
            </p>
            <p class="control">
              <input id="fq-modal-export-quality-input" class="input is-small" size="1" type="text" value="80" style="text-align: center;">
            </p>
            <p class="control">
              <button id="fq-modal-export-quality-plus" class="button fq-modal-export-quality is-small" data-increment="5">
                <span class="icon is-small" style="pointer-events: none;">
                  <i class="fas fa-plus fa-xs"></i>
                </span>
              </button>
            </p>
          </div>
        </div>
        <!-- End quality -->

        <!-- Size -->
        <div class="field is-grouped is-align-items-baseline mb-4">
          <p class="control">
            <label class="is-size-7">Document dimensions:</label>
          </p>
          <div class="control">
            <div class="select is-small">
              <select id="fq-modal-export-size-select">
                <option value="1">1x (current)</option>
                <option value="2">2x</option>
                <option value="3">3x</option>
                <option value="4">4x</option>
                <option value="8">8x</option>
              </select>
            </div>
          </div>
        </div>
        <!-- End size -->

        <div class="field is-grouped is-grouped-centered">
          <p class="control">
            <a id="fq-modal-export-btn-export" class="button is-link is-small">
              Export
            </a>
          </p>
          <p class="control">
            <a class="button is-link is-outlined fq-modal-cancel-btn is-small">
              Cancel
            </a>
          </p>
        </div>
      </div>
    </div>
  </div>
  <canvas id="fq-canvas" style="background-color: rgba(255, 255, 255, 0);"></canvas>
  <div id="fq-svg-container" style="display:none;"></div>
</body>

</html>